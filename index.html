<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Windows Updates & Patches — Last 90 Days</title>
<style>
    :root { --bg:#0b0f14; --card:#121821; --text:#e7eef5; --muted:#a3b3c2; --accent:#4da3ff; }
    * { box-sizing: border-box; }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; background: var(--bg); color: var(--text); }
    header { padding: 20px 24px; border-bottom: 1px solid rgba(255,255,255,.08); }
    h1 { margin:0 0 6px; font-size: 22px; line-height:1.2; }
    .sub { color: var(--muted); font-size: 13px; }
    .wrap { padding: 16px 24px 40px; }
    .toolbar { display:flex; gap:8px; flex-wrap:wrap; margin: 12px 0 12px; align-items:center; }
    .btn { appearance:none; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.04); color:var(--text);
            padding:8px 12px; border-radius:10px; font-size:14px; cursor:pointer; }
    .btn:hover { background: rgba(255,255,255,.08); }
    .btn:active { transform: translateY(1px); }
    .searchbox { display:flex; gap:6px; align-items:center; background:rgba(255,255,255,.05); border-radius:10px; padding:6px 10px; }
    .searchbox input { flex:1; background:none; border:none; color:var(--text); font-size:14px; outline:none; min-width:240px; }
    .filterpanel { display:none; background: rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.12); padding:10px; border-radius:12px; margin: 4px 0 10px; }
    .chips { display:flex; gap:12px; flex-wrap:wrap; }
    .chip { display:flex; gap:6px; align-items:center; background: rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); padding:6px 8px; border-radius:999px; font-size:13px; }
    .chip input { transform: translateY(1px); }
    .card { background: var(--card); border: 1px solid rgba(255,255,255,.06); border-radius: 16px; overflow-x:auto; box-shadow: 0 10px 30px rgba(0,0,0,.25);}
    table { width: 100%; border-collapse: collapse; font-size: 14px; }
    thead th { text-align: left; font-weight: 600; padding: 12px 16px; background: rgba(255,255,255,.03); position: sticky; top:0; }
    tbody td { padding: 10px 16px; vertical-align: top; border-top: 1px solid rgba(255,255,255,.06); }
    tbody tr:hover { background: rgba(77,163,255,.06); }
    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }
    .badge { display:inline-block; padding: 4px 8px; border-radius: 999px; background: rgba(77,163,255,.15); color: var(--accent); font-size: 12px; font-weight: 600; }
    .muted { color: var(--muted); }
    footer { color: var(--muted); font-size: 12px; padding: 12px 2px 0; }
    .meta { color: var(--muted); font-size: 12px; margin-left: 8px; }
    @media print {
        body { background: #fff; color:#000; }
        header, .toolbar, .filterpanel, footer { display:none; }
        .card { box-shadow: none; border: none; }
        a { color: #000; text-decoration: underline; }
        .badge { background: #eee; color: #000; }
    }
</style>
</head>
<body>
<header>
  <h1>Windows Updates & Patches — Last 90 Days</h1>
  <div class="sub">Coverage window: Aug 12, 2025 → Nov 10, 2025 • Initially sorted by date (newest first)</div>
  <div class="toolbar">
    <div class="searchbox">
      <input type="text" id="searchInput" placeholder="Search KB, OS version, details, or issues...">
      <button class="btn" id="btnSearch">Search</button>
      <button class="btn" id="btnClearSearch">Clear</button>
      <span class="meta" id="matchCount"></span>
    </div>
    <button class="btn" id="btnSortOS" title="Sort by Product / OS">Sort by OS (A→Z)</button>
    <button class="btn" id="btnResetSort" title="Reset to newest first">Reset sort</button>
    <button class="btn" id="btnFilterOS" title="Filter by OS version">Filter by OS</button>
    <button class="btn" id="btnPrint" title="Print to PDF">Print</button>
    <button class="btn" id="btnEmail" title="Open email with summary">Email</button>
  </div>
  <div class="filterpanel" id="filterPanel">
    <div class="chips" id="chips"></div>
    <div style="margin-top:8px; display:flex; gap:8px; align-items:center;">
      <button class="btn" id="btnSelectAll">Select all</button>
      <button class="btn" id="btnClear">Clear</button>
      <span class="muted" id="activeFilterNote"></span>
    </div>
  </div>
</header>
<div class="wrap">
  <div class="card">
    <table id="updatesTable">
      <thead>
        <tr>
          <th>Date</th>
          <th>KB</th>
          <th>Product / Version</th>
          <th>Classification</th>
          <th>Details</th>
          <th>Known issues</th>
          <th>Severity</th>
        </tr>
      </thead>
      <tbody>
        <tr>
            <td data-col="date">Oct 28, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5067036" target="_blank" rel="noopener">KB5067036</a></td>
            <td data-col="product">Windows 11 24H2 / 25H2</td>
            <td data-col="class">Preview (Non-security)</td>
            <td data-col="details">Cumulative non-security preview update; additional fixes including media DRM/EVR improvements and IIS/HTTP.sys related reliability updates.</td>
            <td data-col="issues">Addresses prior issues with protected content playback and IIS/HTTP.sys connectivity noted after September preview and October security updates.</td>
            <td data-col="sev"><span class="badge">Preview</span></td>
        </tr>
<tr>
            <td data-col="date">Oct 20, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5070773" target="_blank" rel="noopener">KB5070773</a></td>
            <td data-col="product">Windows 11 24H2 / 25H2</td>
            <td data-col="class">Out-of-band</td>
            <td data-col="details">Fixes USB devices not working in Windows Recovery Environment after the Oct 14 security update; updates AI component versions; includes cumulative fixes from 10/14.</td>
            <td data-col="issues">Some Blu-ray/DVD/DTV apps may fail to play protected content (EVR/HDCP/DRM); IIS websites might fail to load in some environments (addressed by later preview).</td>
            <td data-col="sev"><span class="badge">Important (quality)</span></td>
        </tr>
<tr>
            <td data-col="date">Oct 14, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5066835" target="_blank" rel="noopener">KB5066835</a></td>
            <td data-col="product">Windows 11 24H2 / 25H2</td>
            <td data-col="class">Security Update (Patch Tuesday)</td>
            <td data-col="details">October 2025 cumulative security update; includes security fixes and quality improvements. Disables File Explorer preview for files from the internet to mitigate a vulnerability.</td>
            <td data-col="issues">See Release notes: includes items like NDI streaming performance prior to Sept fix; other product-specific items may apply. Use MSRC for CVE details.</td>
            <td data-col="sev"><span class="badge">Security</span></td>
        </tr>
<tr>
            <td data-col="date">Oct 14, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5066793" target="_blank" rel="noopener">KB5066793</a></td>
            <td data-col="product">Windows 11 22H2 / 23H2</td>
            <td data-col="class">Security Update (Patch Tuesday)</td>
            <td data-col="details">October 2025 cumulative security update; contains security fixes and quality improvements.</td>
            <td data-col="issues">Microsoft is not currently aware of any issues for this release.</td>
            <td data-col="sev"><span class="badge">Security</span></td>
        </tr>
<tr>
            <td data-col="date">Oct 14, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5066791" target="_blank" rel="noopener">KB5066791</a></td>
            <td data-col="product">Windows 10 21H2 / 22H2 (incl. LTSC 2021)</td>
            <td data-col="class">Security Update (Patch Tuesday)</td>
            <td data-col="details">October 2025 cumulative security update; includes SSU improvements and various fixes (IME, WinRM, certificate chain for Azure validation, etc.).</td>
            <td data-col="issues">Incorrect &#x27;End of support&#x27; message may appear on some editions enrolled in ESU or LTSC 2021; mitigations and Group Policy available.</td>
            <td data-col="sev"><span class="badge">Security</span></td>
        </tr>
<tr>
            <td data-col="date">Sep 29, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5065789" target="_blank" rel="noopener">KB5065789</a></td>
            <td data-col="product">Windows 11 25H2 / 24H2</td>
            <td data-col="class">Preview (Non-security)</td>
            <td data-col="details">Non-security preview addressing protected content playback issues and other quality improvements.</td>
            <td data-col="issues">Addresses issues introduced by prior preview/security releases with EVR/DRM playback and HTTP.sys/IIS connectivity.</td>
            <td data-col="sev"><span class="badge">Preview</span></td>
        </tr>
<tr>
            <td data-col="date">Sep 23, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5065790" target="_blank" rel="noopener">KB5065790</a></td>
            <td data-col="product">Windows 11 23H2</td>
            <td data-col="class">Preview (Non-security)</td>
            <td data-col="details">Non-security preview for Windows 11 23H2; quality fixes including SMBv1 connectivity resolution following Sept security update.</td>
            <td data-col="issues">Addresses SMBv1 protocol connectivity problems observed after September&#x27;s security update.</td>
            <td data-col="sev"><span class="badge">Preview</span></td>
        </tr>
<tr>
            <td data-col="date">Sep 22, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5068221" target="_blank" rel="noopener">KB5068221</a></td>
            <td data-col="product">Windows 11 24H2</td>
            <td data-col="class">Out-of-band</td>
            <td data-col="details">OOB cumulative update with App-V compatibility fix; includes Sept 9 security content; SSU KB5064531 included.</td>
            <td data-col="issues">SMBv1 connectivity problems after Sept 9 security update; later addressed by KB5065789.</td>
            <td data-col="sev"><span class="badge">Important (quality)</span></td>
        </tr>
<tr>
            <td data-col="date">Sep 09, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5065426" target="_blank" rel="noopener">KB5065426</a></td>
            <td data-col="product">Windows 11 24H2</td>
            <td data-col="class">Security Update (Patch Tuesday)</td>
            <td data-col="details">September 2025 cumulative security update; includes security fixes and quality improvements for 24H2.</td>
            <td data-col="issues">See page for any active advisories; general guidance on Secure Boot cert updates.</td>
            <td data-col="sev"><span class="badge">Security</span></td>
        </tr>
<tr>
            <td data-col="date">Sep 09, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5065431" target="_blank" rel="noopener">KB5065431</a></td>
            <td data-col="product">Windows 11 22H2 / 23H2</td>
            <td data-col="class">Security Update (Patch Tuesday)</td>
            <td data-col="details">September 2025 cumulative security update; includes SMB client/server auditing and MSI repair UAC behavior fixes.</td>
            <td data-col="issues">SMBv1 protocol connections over NetBT can fail after installing Sept 2025 update; addressed by KB5065790.</td>
            <td data-col="sev"><span class="badge">Security</span></td>
        </tr>
<tr>
            <td data-col="date">Sep 09, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5065429" target="_blank" rel="noopener">KB5065429</a></td>
            <td data-col="product">Windows 10 21H2 / 22H2 (incl. LTSC 2021)</td>
            <td data-col="class">Security Update (Patch Tuesday)</td>
            <td data-col="details">September 2025 cumulative security update; includes internal OS security improvements.</td>
            <td data-col="issues">Reset &amp; recovery operations may fail (resolved by later updates); NDI streaming and unexpected MSI repair UAC prompts resolved in Sept 9 update.</td>
            <td data-col="sev"><span class="badge">Security</span></td>
        </tr>
<tr>
            <td data-col="date">Aug 29, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5064081" target="_blank" rel="noopener">KB5064081</a></td>
            <td data-col="product">Windows 11 24H2</td>
            <td data-col="class">Preview (Non-security)</td>
            <td data-col="details">Non-security preview for 24H2; quality improvements.</td>
            <td data-col="issues">Introduced issues playing protected content in some media apps (later addressed by Sept preview and Oct preview).</td>
            <td data-col="sev"><span class="badge">Preview</span></td>
        </tr>
<tr>
            <td data-col="date">Aug 12, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5063878" target="_blank" rel="noopener">KB5063878</a></td>
            <td data-col="product">Windows 11 24H2</td>
            <td data-col="class">Security Update (Patch Tuesday)</td>
            <td data-col="details">August 2025 cumulative security update for Windows 11 24H2.</td>
            <td data-col="issues">See page; none widely documented at release.</td>
            <td data-col="sev"><span class="badge">Security</span></td>
        </tr>
<tr>
            <td data-col="date">Aug 12, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5063875" target="_blank" rel="noopener">KB5063875</a></td>
            <td data-col="product">Windows 11 22H2 / 23H2</td>
            <td data-col="class">Security Update (Patch Tuesday)</td>
            <td data-col="details">August 2025 cumulative security update for Windows 11 22H2/23H2.</td>
            <td data-col="issues">See page; none widely documented at release.</td>
            <td data-col="sev"><span class="badge">Security</span></td>
        </tr>
<tr>
            <td data-col="date">Aug 12, 2025</td>
            <td data-col="kb"><a href="https://support.microsoft.com/en-us/help/5063709" target="_blank" rel="noopener">KB5063709</a></td>
            <td data-col="product">Windows 10 21H2 / 22H2 (incl. LTSC 2021)</td>
            <td data-col="class">Security Update (Patch Tuesday)</td>
            <td data-col="details">August 2025 cumulative security update; later changelog added notes about reset/recovery, NDI streaming, and MSI repair UAC prompt behavior.</td>
            <td data-col="issues">Reset &amp; recovery may fail; NDI streaming performance issues; unexpected UAC prompts on MSI repair (resolved by Sept updates).</td>
            <td data-col="sev"><span class="badge">Security</span></td>
        </tr>
      </tbody>
    </table>
  </div>
  <footer>Tip: Search narrows results live and works together with OS filters. Email uses whatever is currently visible.</footer>
</div>
<script>
(function(){
  const table = document.getElementById('updatesTable');
  const tbody = table.querySelector('tbody');
  const origRows = Array.from(tbody.querySelectorAll('tr'));
  let osAsc = true;

  // --- Rolling window (last 90 days) & header update ---
  const today = new Date();
  // Show today + prior 89 days to yield a 90-day inclusive window
  const startDate = new Date(today);
  startDate.setDate(startDate.getDate() - 89);
  const fmt = (d) => d.toLocaleDateString('en-US', { month: 'short', day: '2-digit', year: 'numeric' }).replace(/\b0(\d)/, '$1');
  const subEl = document.querySelector('header .sub');
  if (subEl) {
    subEl.textContent = `Coverage window: ${fmt(startDate)} → ${fmt(today)} • Initially sorted by date (newest first)`;
  }


  // --- Utilities ---
  const $ = (sel) => document.querySelector(sel);
  const $$ = (sel) => Array.from(document.querySelectorAll(sel));
  const getText = (el) => (el?.textContent || '').trim();

  // --- Sorting ---
  function sortByOS() {
    const rows = Array.from(tbody.querySelectorAll('tr'));
    rows.sort((a,b) => {
      const ap = getText(a.querySelector('td[data-col="product"]')).toLowerCase();
      const bp = getText(b.querySelector('td[data-col="product"]')).toLowerCase();
      if (ap < bp) return osAsc ? -1 : 1;
      if (ap > bp) return osAsc ? 1 : -1;
      const ad = Date.parse(getText(a.querySelector('td[data-col="date"]')));
      const bd = Date.parse(getText(b.querySelector('td[data-col="date"]')));
      return bd - ad;
    });
    tbody.innerHTML = '';
    rows.forEach(r => tbody.appendChild(r));
    $('#btnSortOS').textContent = osAsc ? 'Sort by OS (Z→A)' : 'Sort by OS (A→Z)';
    osAsc = !osAsc;
    applyCombinedFilter(); // keep filters respected after sorting
  }

  function resetSort() {
    tbody.innerHTML = '';
    origRows.forEach(r => tbody.appendChild(r));
    osAsc = true;
    $('#btnSortOS').textContent = 'Sort by OS (A→Z)';
    applyCombinedFilter();
  }

  // --- Filter by OS (checkbox panel) ---
  const panel = $('#filterPanel');
  const chips = $('#chips');
  const note = $('#activeFilterNote');

  function uniqueProducts() {
    const set = new Set();
    $$('#updatesTable td[data-col="product"]').forEach(td => set.add(getText(td)));
    return Array.from(set).sort((a,b)=>a.localeCompare(b));
  }

  function buildChips() {
    chips.innerHTML = '';
    uniqueProducts().forEach(p => {
      const id = 'chk_' + p.replace(/[^a-z0-9]+/gi,'_');
      const lab = document.createElement('label');
      lab.className = 'chip';
      const input = document.createElement('input');
      input.type = 'checkbox';
      input.checked = true;
      input.dataset.os = p;
      input.id = id;
      const span = document.createElement('span');
      span.textContent = p;
      lab.appendChild(input);
      lab.appendChild(span);
      chips.appendChild(lab);
      input.addEventListener('change', applyCombinedFilter);
    });
  }

  function activeOSList() {
    return Array.from(chips.querySelectorAll('input[type="checkbox"]'))
      .filter(cb => cb.checked)
      .map(cb => cb.dataset.os);
  }
  function allOSList() {
    return Array.from(chips.querySelectorAll('input[type="checkbox"]')).map(cb => cb.dataset.os);
  }

  // --- Search ---
  const searchInput = $('#searchInput');
  const matchCount = $('#matchCount');

  
  function applyCombinedFilter() {
    const term = (searchInput?.value || '').toLowerCase().trim();
    const active = activeOSList();
    const all = allOSList();
    let shown = 0;

    $$('#updatesTable tbody tr').forEach(tr => {
      const product = getText(tr.querySelector('td[data-col="product"]'));
      const text = tr.innerText.toLowerCase();
      const dateText = getText(tr.querySelector('td[data-col="date"]'));
      const d = new Date(dateText);

      // Normalize to local midnight for inclusive comparisons
      const dMid = new Date(d.getFullYear(), d.getMonth(), d.getDate());
      const startMid = new Date(startDate.getFullYear(), startDate.getMonth(), startDate.getDate());
      const endMid = new Date(today.getFullYear(), today.getMonth(), today.getDate());

      const inRange = dMid >= startMid && dMid <= endMid;
      const matchOS = active.length === 0 ? false : active.includes(product);
      const matchSearch = term === '' ? true : text.includes(term);
      const visible = inRange && matchOS && matchSearch;

      tr.style.display = visible ? '' : 'none';
      if (visible) shown += 1;
    });

    note.textContent = active.length === all.length || active.length === 0 ? '' : ('Active OS filters: ' + active.join(', '));
    if (term) { matchCount.textContent = shown + ' match' + (shown===1?'':'es'); }
    else { matchCount.textContent = ''; }
  }
    else { matchCount.textContent = ''; }
  }

  // --- Email helpers ---
  function toEmailSafe(text, maxLen) {
    const enc = encodeURIComponent(text);
    return enc.length > maxLen ? enc.slice(0, maxLen) + '%0A%0A%5Btruncated%5D' : enc;
  }
  function draftEmail() {
    const lines = [];
    lines.push('Windows Updates & Patches — Last 90 Days');
    lines.push(`Coverage: ${fmt(startDate)} to ${fmt(today)}`);
    lines.push('');
    $$('#updatesTable tbody tr').forEach(tr => {
      if (tr.style.display === 'none') return;
      const date = getText(tr.querySelector('td[data-col="date"]'));
      const kb = getText(tr.querySelector('td[data-col="kb"]'));
      const kbLink = tr.querySelector('td[data-col="kb"] a')?.href || '';
      const product = getText(tr.querySelector('td[data-col="product"]'));
      const cls = getText(tr.querySelector('td[data-col="class"]'));
      const sev = getText(tr.querySelector('td[data-col="sev"]'));
      const issues = getText(tr.querySelector('td[data-col="issues"]'));
      const line = '• ' + date + ' — ' + kb + ' — ' + product + ' — ' + sev + ' — ' + cls + '\n  ' + kbLink + '\n  Issues: ' + issues;
      lines.push(line);
    });
    lines.push('\n(Attach the HTML report if needed)');
    const subject = encodeURIComponent('Windows updates (last 90 days)');
    const body = toEmailSafe(lines.join('\n'), 1800);
    const mailto = 'mailto:?subject=' + subject + '&body=' + body;
    window.location.href = mailto;
  }

  // --- Wire up UI ---
  $('#btnSortOS').addEventListener('click', sortByOS);
  $('#btnResetSort').addEventListener('click', resetSort);
  $('#btnFilterOS').addEventListener('click', () => {
    panel.style.display = (panel.style.display === 'none' || panel.style.display === '') ? 'block' : 'none';
  });
  $('#btnPrint').addEventListener('click', () => window.print());
  $('#btnEmail').addEventListener('click', draftEmail);

  $('#btnSearch').addEventListener('click', applyCombinedFilter);
  $('#btnClearSearch').addEventListener('click', () => { searchInput.value=''; applyCombinedFilter(); });
  searchInput.addEventListener('keyup', (e) => { if (e.key === 'Enter') applyCombinedFilter(); });

  // Filter panel helpers
  $('#btnSelectAll').addEventListener('click', () => {
    chips.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = true);
    applyCombinedFilter();
  });
  $('#btnClear').addEventListener('click', () => {
    chips.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
    applyCombinedFilter();
  });

  // Init
  buildChips();
  applyCombinedFilter();
})();

  // --- Auto-refresh shortly after midnight so the window rolls automatically ---
  (function scheduleDailyRefresh(){
    const now = new Date();
    const next = new Date(now);
    next.setDate(now.getDate() + 1);
    next.setHours(0, 15, 0, 0); // 00:15 local time
    const ms = next.getTime() - now.getTime();
    if (ms > 0 && ms < 48*60*60*1000) {
      setTimeout(() => location.reload(), ms);
    }
  })();
</script>
</body>
</html>
